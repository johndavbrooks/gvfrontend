import{r,u as C,y as a,a as y,b as N,j as e,F as v,c as L,L as w}from"./index-Ck0xZ38V.js";function T(){const[n,h]=r.useState({email:"",password:""}),[t,m]=r.useState(!1),c=C(),d=r.useRef(null),g=r.useCallback(i=>{const{name:l,value:o}=i.target;d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{h(u=>({...u,[l]:o}))},300),i.target.value=o},[]),b=r.useCallback(async i=>{var l,o,u,p;if(i.preventDefault(),!t){m(!0);try{const s=a.loading("Logging in..."),f=await y.post(`${N}/users/login`,n,{headers:{"Content-Type":"application/json"},timeout:1e4});if(f.status===200){a.update(s,{render:"Login successful! Redirecting...",type:"success",isLoading:!1,autoClose:2e3});const{sessionId:x,user:j}=f.data;localStorage.setItem("sessionId",x),localStorage.setItem("userData",JSON.stringify(j)),setTimeout(()=>{c("/home")},1e3)}}catch(s){console.error("Error:",s),a.dismiss(),s.code==="ECONNABORTED"?a.error("Connection timeout. Please try again."):((l=s.response)==null?void 0:l.status)===401?a.error("Invalid email or password."):((o=s.response)==null?void 0:o.status)===404?a.error("Account not found. Please check your email."):a.error(((p=(u=s.response)==null?void 0:u.data)==null?void 0:p.message)||"Login failed. Please try again.")}finally{m(!1)}}},[n,t,c]);return e.jsxs("div",{className:"login-container",children:[e.jsxs("form",{onSubmit:b,className:"login-form",children:[e.jsx("h2",{children:"Login"}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"email",name:"email",defaultValue:n.email,onChange:g,placeholder:"Email",required:!0,autoComplete:"email"}),e.jsx(v,{className:"input-icon"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"password",name:"password",defaultValue:n.password,onChange:g,placeholder:"Password",required:!0,autoComplete:"current-password"}),e.jsx(L,{className:"input-icon"})]}),e.jsx("button",{type:"submit",className:"login-button",disabled:t,children:t?"Logging in...":"Login"}),e.jsx("div",{className:"form-divider",children:"or"}),e.jsx("button",{type:"button",className:"register-link-button",onClick:()=>c("/Registration"),disabled:t,children:"Create New Account"})]}),e.jsx(w,{position:"bottom-center",autoClose:4e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}export{T as default};
